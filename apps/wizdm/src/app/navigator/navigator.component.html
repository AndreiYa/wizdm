<header fxFlex="0 0 auto">
  <mat-toolbar>

    <!-- Background w/ shadow to fade while blending in -->
    <div class="background" [@blendin]="!menu && !(scrolled$ | async)"></div>

    <!-- Navigation bar -->
    <mat-toolbar-row fxLayoutAlign="space-between center">

      <!-- Left pane -->
      <nav fxLayout="row" fxLayoutAlign="start center">

        <!-- Mobile menu toggler -->
        <button mat-icon-button (click)="toggleMenu()" *ngIf="mobile">
          <wm-toggler toggler-style="menu" [status]="toggler"></wm-toggler>
        </button>

        <!-- Wizdm logo routing to home -->
        <wm-logo [caption]="msgs.logo" routerLink="."></wm-logo>  
    
        <!-- Desktop navigation links -->
        <wm-navbar [menuItems]="desktopMenu" *ngIf="desktop"></wm-navbar>
      
      </nav>

      <!-- Right pane -->
      <div fxLayout="row" fxLayoutAlign="end center" *ngIf="signedIn">

        <!-- Action toolbar -->
        <wm-toolbar  *ngIf="someActions$ | async" [buttons]="actionButtons$ | async"></wm-toolbar>

        <!-- User profile button -->
        <button mat-icon-button routerLink="profile">
          <wm-avatar [src]="userImage"></wm-avatar>
        </button>

      </div>
    
    </mat-toolbar-row>

    <!-- Mobile menu -->
    <mat-toolbar-row auto *ngIf="mobile">
      
      <wm-menu [menuItems]="mobileMenu" [toggle]="toggler" (visible)="menu = $event"></wm-menu>    
    
    </mat-toolbar-row>

    <!-- Error message displayer -->
    <mat-toolbar-row auto>

      <wm-errors [error]="error" (clear)="clearError()"></wm-errors>
  
    </mat-toolbar-row>

  </mat-toolbar>

</header>

<!-- Viewport container -->
<main fxFlex="1 1 auto" fxLayout="column">

  <!-- Content Viewport (scrollable) -->
  <!--wm-viewport fxFlex="1 1 auto" fxLayout="column" treshold="20" [(scrolled)]="scrolled"--> 
  <div fxFlex="1 1 auto" fxLayout="column"> 

    <!-- Router Outlet stretched to fit -->
    <div fxFlex="1 1 auto">
      <router-outlet (deactivate)="clearActions()">
      </router-outlet>
    </div>
    
    <!-- Footer always on the bottom -->
    <wm-footer fxFlex="0 0 auto" [language]="!signedIn"></wm-footer>
  </div>
</main>

<!--wm-consent [ask]="askConsent" (granted)="consentGranted()"></wm-consent-->
  